<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title class="translate" data-translate="pageTitleContact"></title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Meow+Script&family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Jersey+10+Charted&family=Outfit:wght@100..900&family=Tiny5&family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/contact.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="icon" type="image/png" href="img/favico.png">
</head>

<body>
    <!-- Splash Screen -->
    <div id="splash-screen"></div>
    <div class="loading-dots">
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
    </div>

    <!-- Darkening -->
    <div id="darkening">
        <div class="loading-dots">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </div>
    </div>

    <!-- Navigator -->
    <header>
        <nav>
            <button class="menu-toggle" aria-label="Toggle navigation">☰</button>
            <ul class="nav-links">
                <li><a href="index.html" class="translate" data-translate="home"></a></li>
                <li><a href="about.html" class="translate" data-translate="about"></a></li>
                <li><a href="projects.html" class="translate" data-translate="projects"></a></li>
                <li><a href="experience.html" class="translate" data-translate="experience"></a></li>
                <li><a href="#" class="translate active-nav" data-translate="contact"></a></li>
            </ul>
            <div class="language-switcher">
                <button onclick="setLanguage('pl'); setPlaceholders(); document.getElementById('responseMessage').innerText = '';" class="lang-button" title="Przełącz język strony na polski.">
                    <div class="lang-content">
                        <img src="img/pl_lang.png" draggable="false" alt="Polish Flag">PL
                    </div>
                </button>
                <button onclick="setLanguage('en'); setPlaceholders(); document.getElementById('responseMessage').innerText = '';" class="lang-button" title="Change website language to english.">
                    <div class="lang-content">
                        <img src="img/eng_lang.png" draggable="false" alt="English Flag">EN
                    </div>
                </button>
            </div>
        </nav>
    </header>

    <!-- Content -->
    <div class="body2"></div>

    <div>
        <p class="title translate shadowedImageSmall" data-translate="contact" style="margin-top: 100px;"></p>
    </div>

    <img src="img/contactClouds.png" class="contactClouds imageScaling shadowedImageSmall" draggable="false">

    <div class="content">
        <main>
            <div class="contactContent">
                <div class="xp-window">
                    <div class="xp-title-bar">
                        <div class="xp-title-bar-text">
                            <img src="img/xpcontact.png" class="cursor-default" style="transform: scale(0.9); cursor: url('/img/cursor.cur'), auto !important;" draggable="false">
                        <p class="translate cursor-default" data-translate="contactXpWindowTitle" style="cursor: url('/img/cursor.cur'), auto !important;"></p>
                        </div>
                        <div class="buttons">
                            <div class="button" style="font-size: large; user-select: none;">_</div>
                        </div>
                    </div>
                                    
                    <div class="xp-content">
                        <p class="translate" data-translate="contactXpWindowText1" style="font-size: 25px; margin-bottom: 15px; font-weight: 500; letter-spacing: -1px; line-height: 1;"></p>
                        <p class="translate" data-translate="contactXpWindowText2" style="font-size: 25px; margin-bottom: 15px; font-weight: 500; letter-spacing: -1px; line-height: 1;"></p>
                        <div>
                            <p class="translate" data-translate="contactXpWindowText3" style="font-size: 25px; display: inline; margin: 0; font-weight: 500; letter-spacing: -1px; line-height: 1;"></p>
                            <img src="img/emote.gif" draggable="false" style="display: inline; transform: translate(2px, 3px) scale(1.3);">
                        </div>
                        
                        <form class="contact-form" id="contactForm">
                            <label for="name" class="translate" data-translate="contactXpWindowName"></label>
                            <input type="text" style="cursor: url('/img/cursor2.cur'), auto;" id="name" name="name" required>
                            
                            <label for="email" class="translate" data-translate="contactXpWindowEmail"></label>
                            <input type="email" style="cursor: url('/img/cursor2.cur'), auto;" id="email" name="email" required>
                            
                            <label for="message" class="translate" data-translate="contactXpWindowMessageContent"></label>
                            <textarea id="message" style="cursor: url('/img/cursor2.cur'), auto;" name="message" rows="4" required></textarea>
                            
                            <div style="display: flex; justify-content: center;">
                                <button type="button" onclick="sendEmail()" class="cursor-default" style="cursor: url('/img/cursor3.cur'), auto;">OK</button>
                            </div>
                        </form>
                    
                        <!-- Dodaj element do wyświetlenia komunikatu zwrotnego -->
                        <p id="responseMessage" style="margin-top: 10px; font-size: 22px; font-weight: 500; letter-spacing: -1px; line-height: 1; text-align: center;"></p>
                    </div>
                </div>

                <img src="img/rover1.png" class="cursor-default shadowedImage" draggable="false" id="rover1" alt="Rover" title="Rover">

                <div class="xp-deco-window1" style="right: 1100px; top: 170px; height: 600px; width: 700px;">
                    <div class="xp-deco-title-bar cursor-default" style="line-height: 0; color: rgba(255, 255, 255, 0.486);"></div>
                </div>
                <div class="xp-deco-window2" style="left: 730px; top: 85px; height: 600px; width: 700px;">
                    <div class="xp-deco-title-bar cursor-default" style="line-height: 0; color: rgba(255, 255, 255, 0.486);">... ... ......</div>
                </div>

                <div class="xp-deco-window" style="left: 120px; top: 450px; height: 300px; width: 400px;">
                    <div class="xp-deco-title-bar cursor-default" style="line-height: 0; color: rgba(255, 255, 255, 0.486);">.. ... ... ...</div>
                </div>
                <div class="xp-deco-window" style="left: 30px; top: 300px; height: 200px; width: 300px; background-color: #d1d1d18a;">
                    <div class="xp-deco-title-bar cursor-default" style="line-height: 0; color: rgba(255, 255, 255, 0.486); background-color: #0045bb5b;">...... ... ...</div>
                </div>

                <div class="xp-deco-window" style="right: 30px; top: 200px; width: 500px;">
                    <div class="xp-deco-title-bar cursor-default" style="line-height: 0; color: rgba(255, 255, 255, 0.486);">... ...... ...</div>
                </div>
                <div class="xp-deco-window" style="right: 40px; top: 350px; height: 300px; width: 350px; background-color: #d1d1d18a;">
                    <div class="xp-deco-title-bar cursor-default" style="line-height: 0; color: rgba(255, 255, 255, 0.486); background-color: #0045bb5b;">... ... ......</div>
                </div>
            </div>

            <div class="closedWindowContent">
                <div class="xp-window"  style="top: 0;">
                    <div class="xp-title-bar">
                        <div class="xp-title-bar-text">
                            <img src="img/xpalert.png" class="cursor-default" style="transform: scale(0.9) scaleY(0.8); cursor: url('/img/cursor.cur'), auto !important;">
                        <p class="translate cursor-default" data-translate="contactXpWindowAlertTitle" style="cursor: url('/img/cursor.cur'), auto !important;"></p>
                        </div>
                        <div class="buttons">
                            <div class="closeButton"><p style="font-size: 45px; line-height: 0; transform: translateY(-4.5px) scaleX(1.4); user-select: none;">x</p></div>
                        </div>
                    </div>
                                    
                    <div class="xp-content">
                        <img src="img/rover2.png" class="cursor-default shadowedImage" draggable="false" id="rover2" alt="Rover" title="Rover!">
                        <p class="translate" data-translate="contactXpWindowAlertText1" style="font-size: 25px; margin-bottom: 15px; font-weight: 500; letter-spacing: -1px; line-height: 1; transform: translateY(-15px);"></p>
                        <a class="openWindow translate" data-translate="contactXpWindowAlertText2" style="font-size: 25px; margin-bottom: 15px; font-weight: 500; letter-spacing: -1px; line-height: 1; text-decoration: underline; cursor: url('/img/cursor3.cur'), auto;"></a>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- CV Download -->
    <div class="cv-download shadowedImageSmall">
        <img src="img/pdf.png" alt="PDF" class="pdf-icon" draggable="false">
        <a href="Wiktor Gołąb CV.pdf" download class="translate" data-translate="otherCV" title="Wiktor Gołąb CV.pdf"></a>
    </div>

    <!-- Footer HTML -->
    <footer style="margin-top: 30px;">
        <div class="footerimg">
            <img src="img/contactfooterimage.png" alt="Footer Image" class="footer-image cursor-default" draggable="false">
            <img src="img/contactfooterbirds.gif" alt="Footer Birds" draggable="false" class="footer-birds animate">
        </div>
        <div class="footer-content">
            <!-- Imię i nazwisko oraz social media -->
            <div class="name-and-links">
                <p class="name cursor-default" title="Tego gościa nie skopiujesz">Wiktor Gołąb</p>
                <div class="social-links">
                    <a href="https://github.com/WiktorGolab" target="_blank" title="Github">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://www.linkedin.com/in/wiktorgolab/" target="_blank" title="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </div>
            </div>
                
            <!-- Linki nawigacyjne -->
            <div class="footer-nav">
                <a href="index.html" class="translate" data-translate="home"></a>
                <a href="about.html" class="translate" data-translate="about"></a>
                <a href="projects.html" class="translate" data-translate="projects"></a>
                <a href="experience.html" class="translate" data-translate="experience"></a>
                <a href="#" class="translate" data-translate="contact"></a>
            </div>
        </div>
    </footer>

    <script src="js/script.js"></script>
    <script src="js/language.js" defer></script>
    <script src="js/contact.js"></script>
    <script>
        // Uruchomienie funkcji po załadowaniu strony
        window.onload = () => {
            
            const splashScreen = document.getElementById("splash-screen");
            const loadingDots = document.querySelector(".loading-dots");

            // Dodaj klasę "hidden" dla efektu zanikania
            splashScreen.style.opacity = 0;
            loadingDots.style.opacity = 0;

            splashScreen.style.pointerEvents = "none";
            loadingDots.style.pointerEvents = "none";

            // Po zakończeniu animacji ukryj splash screen i pokaż treść
            splashScreen.addEventListener("transitionend", function() {
                splashScreen.style.display = "none"; // Ukryj splash screen
                loadingDots.style.display = "none"; // Ukryj kropki ładowania
            });
        };
    </script>
    <script>
        // Funkcja do ustawienia placeholderów
        function setPlaceholders() {
            const lang = localStorage.getItem('language') || 'pl';
    
            document.getElementById('name').placeholder = translations[lang].contactFormPlaceholderName;
            document.getElementById('email').placeholder = translations[lang].contactFormPlaceholderEmail;
            document.getElementById('message').placeholder = translations[lang].contactFormPlaceholderMessage;
        }
    
        // Dodanie listenera do załadowania formularza
        document.addEventListener("DOMContentLoaded", () => {
            setPlaceholders();
        });
    </script>
    <script>
        async function sendEmail() {
            const email = document.getElementById('email').value;
            const message = document.getElementById('message').value;
            const responseMessage = document.getElementById('responseMessage');
            const loadingDots = document.querySelectorAll('.loading-dots');
            const darkening = document.getElementById('darkening');
            const loadingDotsContainer = document.getElementById('loadingDotsContainer');

            // Walidacja danych wejściowych
            if (!email || !message) {
                responseMessage.innerText = "Please provide both email and message.";
                responseMessage.style.color = "red";
                resetLoadingState(loadingDots, darkening);
                return;
            }

            // Rozpoczęcie animacji ładowania
            loadingDotsContainer.style.display = "block";
            darkening.style.opacity = 1;

            try {
                // Wysyłanie zapytania do backendu
                const response = await fetch('https://wiktorgolabbackend.netlify.app/.netlify/functions/emailjs', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, message }),
                });

                // Obsługa błędów na poziomie odpowiedzi
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Unknown error occurred.');
                }

                const result = await response.json();

                if (result.success) {
                    responseMessage.innerText = "Email sent successfully!";
                    responseMessage.style.color = "green";
                } else {
                    throw new Error(result.error || 'Failed to send email.');
                }
            } catch (error) {
                // Obsługa błędów sieci lub serwera
                console.error('Error:', error);
                responseMessage.innerText = "An error occurred: " + error.message;
                responseMessage.style.color = "blue";
            } finally {
                // Resetowanie animacji ładowania
                resetLoadingState(loadingDots, darkening);
            }
        }

        // Funkcja resetująca animację ładowania
        function resetLoadingState(loadingDots, darkening) {
            loadingDots.forEach(dot => dot.style.display = "none");
            darkening.style.opacity = 0;
        }
    </script>
</body>
</html>